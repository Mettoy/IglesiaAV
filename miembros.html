<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Miembros | Adoración Viva</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      display: flex;
    }

    /* Menú lateral */
    .sidebar {
      width: 220px;
      background-color: #2c3e50;
      color: white;
      height: 100vh;
      padding: 20px;
    }

    .sidebar img {
      width: 100%;
      margin-bottom: 20px;
    }

    .sidebar h2 {
      font-size: 20px;
      margin-bottom: 10px;
    }

    /* Contenido principal */
    .main {
      flex: 1;
      padding: 20px;
      background-color: #ecf0f1;
    }

    h1 {
      margin-top: 0;
    }

    form {
      background: white;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
    }

    fieldset {
      border: 1px solid #ccc;
      margin-bottom: 15px;
      padding: 10px;
      border-radius: 5px;
    }

    legend {
      font-weight: bold;
    }

    label {
      display: block;
      margin-top: 10px;
    }

    input {
      width: 100%;
      padding: 5px;
      border: 1px solid #aaa;
      border-radius: 4px;
    }

    button {
      margin-top: 15px;
      background-color: #2980b9;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      border-radius: 8px;
    }

    th, td {
      padding: 10px;
      border: 1px solid #ccc;
      text-align: left;
    }

    th {
      background-color: #bdc3c7;
    }

    img.foto-miembro {
      width: 40px;
      height: 40px;
      object-fit: cover;
      border-radius: 50%;
    }
  </style>
</head>
<body>
  <div class="sidebar">
    <img src="https://i.ibb.co/SNPD9g6/logoadoracionviva.png" id="logo" alt="Logo"/>
    <h2>Adoración Viva</h2>
    <p>Miembros</p>
  </div>

  <div class="main">
    <h1>Registrar Miembro</h1>
    <form id="form-miembro">
      <fieldset>
        <legend>Datos Personales</legend>
        <label>Nombre completo: <input type="text" id="nombre" required></label>
        <label>Código: <input type="text" id="codigo" required></label>
        <label>Edad: <input type="number" id="edad" required></label>
        <label>Dirección: <input type="text" id="direccion" required></label>
        <label>Sociedad: <input type="text" id="sociedad" required></label>
      </fieldset>

      <fieldset>
        <legend>Datos Familiares</legend>
        <label>Estado civil: <input type="text" id="estadoCivil"></label>
        <label>Nombre del cónyuge: <input type="text" id="conyuge"></label>
        <label>Hijos: <input type="text" id="hijos"></label>
      </fieldset>

      <fieldset>
        <legend>Datos Espirituales</legend>
        <label>Fecha de conversión: <input type="date" id="fechaConversion"></label>
        <label>Ministerio: <input type="text" id="ministerio"></label>
        <label>Pastor actual: <input type="text" id="pastor"></label>
      </fieldset>

      <button type="submit">Guardar</button>
    </form>

    <h2>Lista de miembros</h2>
    <table id="tabla-miembros">
      <thead>
        <tr>
          <th>Foto</th>
          <th>Nombre</th>
          <th>Código</th>
          <th>Edad</th>
          <th>Dirección</th>
          <th>Sociedad</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAyfPQzO7evryWcQ5d1lGV3z8aB-gFOh_k",
      authDomain: "iglesia-adoracion-viva.firebaseapp.com",
      projectId: "iglesia-adoracion-viva",
      storageBucket: "iglesia-adoracion-viva.appspot.com",
      messagingSenderId: "815332010058",
      appId: "1:815332010058:web:d2afff616469349d88deb3",
      measurementId: "G-43MZP6V55D"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const form = document.getElementById('form-miembro');
    const tabla = document.querySelector('#tabla-miembros tbody');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const miembro = {
        nombre: document.getElementById('nombre').value,
        codigo: document.getElementById('codigo').value,
        edad: document.getElementById('edad').value,
        direccion: document.getElementById('direccion').value,
        sociedad: document.getElementById('sociedad').value,
        estadoCivil: document.getElementById('estadoCivil').value,
        conyuge: document.getElementById('conyuge').value,
        hijos: document.getElementById('hijos').value,
        fechaConversion: document.getElementById('fechaConversion').value,
        ministerio: document.getElementById('ministerio').value,
        pastor: document.getElementById('pastor').value,
        foto: "https://via.placeholder.com/40"
      };

      await db.collection('miembros').add(miembro);
      form.reset();
      cargarMiembros();
    });

    async function cargarMiembros() {
      tabla.innerHTML = '';
      const snapshot = await db.collection('miembros').get();
      snapshot.forEach(doc => {
        const m = doc.data();
        const row = `
          <tr>
            <td><img src="${m.foto}" class="foto-miembro"/></td>
            <td>${m.nombre}</td>
            <td>${m.codigo}</td>
            <td>${m.edad}</td>
            <td>${m.direccion}</td>
            <td>${m.sociedad}</td>
          </tr>
        `;
        tabla.innerHTML += row;
      });
    }

    window.onload = cargarMiembros;
  </script>
</body>
</html>
