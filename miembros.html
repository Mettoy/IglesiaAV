<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Miembros | Adoraci√≥n Viva</title>
  <style>
    /* Estilo aesthetic */
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background-color: #f5f7fa;
      color: #333;
    }
    .sidebar {
      background-color: #001f3f;
      color: white;
      width: 220px;
      min-height: 100vh;
      padding-top: 1rem;
      position: fixed;
      transition: all 0.3s ease;
    }
    .sidebar.collapsed {
      width: 60px;
    }
    .sidebar img {
      width: 150px;
      margin: 0 auto 20px;
      display: block;
    }
    .menu-item {
      padding: 1rem;
      cursor: pointer;
    }
    .menu-item:hover {
      background-color: #003366;
    }
    .container {
      margin-left: 220px;
      padding: 2rem;
      transition: margin-left 0.3s ease;
    }
    .collapsed ~ .container {
      margin-left: 60px;
    }
    h1 {
      color: #001f3f;
    }
    .button {
      background-color: #ffcc00;
      border: none;
      padding: 10px 20px;
      color: #001f3f;
      font-weight: bold;
      cursor: pointer;
      border-radius: 8px;
      margin-bottom: 1rem;
    }
    .form-section {
      background: white;
      padding: 1rem;
      border-radius: 10px;
      margin-bottom: 1rem;
      box-shadow: 0 0 8px rgba(0,0,0,0.1);
    }
    .form-group {
      margin-bottom: 1rem;
    }
    .form-group input, .form-group select {
      width: 100%;
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    .tabs {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
    }
    .tabs button {
      padding: 0.5rem 1rem;
      border: none;
      cursor: pointer;
      border-radius: 6px;
    }
    .tabs button.active {
      background: #001f3f;
      color: white;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
    }
    th, td {
      padding: 10px;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }
    .actions button {
      margin-right: 5px;
    }
    .hidden {
      display: none;
    }
    #member-photo {
      display: block;
      max-width: 100px;
      margin-bottom: 1rem;
    }
  </style>
</head>
<body>
  <div class="sidebar" id="sidebar">
    <img src="https://azywyqozwwbfctxeokug.supabase.co/storage/v1/object/public/logos//images%20(1).png" alt="Logo"/>
    <div class="menu-item" onclick="toggleSidebar()">‚ò∞ Men√∫</div>
  </div>

  <div class="container" id="main">
    <h1>Gesti√≥n de Miembros</h1>
    <button class="button" onclick="toggleForm()">Agregar nuevo miembro</button>

    <form id="member-form" class="hidden">
      <div class="form-section">
        <h3>üì∑ Foto</h3>
        <input type="file" id="photo" />
        <img id="member-photo" src="" alt="" class="hidden"/>
        <h3>üë§ Datos Personales</h3>
        <div class="form-group"><input type="text" id="nombre" placeholder="Nombre completo" required/></div>
        <div class="form-group"><input type="text" id="codigo" placeholder="C√≥digo" required/></div>
        <div class="form-group"><input type="number" id="edad" placeholder="Edad"/></div>
        <div class="form-group"><input type="text" id="direccion" placeholder="Direcci√≥n"/></div>
        <div class="form-group">
          <select id="sociedad">
            <option value="">Seleccionar sociedad</option>
            <option value="j√≥venes">J√≥venes</option>
            <option value="damas">Damas</option>
            <option value="caballeros">Caballeros</option>
          </select>
        </div>
      </div>

      <div class="form-section">
        <h3>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Datos Familiares</h3>
        <div class="form-group"><input type="text" id="estado-civil" placeholder="Estado civil"/></div>
        <div class="form-group"><input type="text" id="hijos" placeholder="Cantidad de hijos"/></div>
      </div>

      <div class="form-section">
        <h3>üôè Datos Espirituales</h3>
        <div class="form-group"><input type="text" id="bautismo" placeholder="Fecha de bautismo"/></div>
        <div class="form-group"><input type="text" id="ministerio" placeholder="Ministerio"/></div>
      </div>

      <button type="submit" class="button">Guardar</button>
    </form>

    <div class="tabs">
      <button class="active" onclick="showTab('activos')">Activos</button>
      <button onclick="showTab('baja')">De Baja</button>
    </div>

    <div id="tabla-activos">
      <table>
        <thead>
          <tr>
            <th>Foto</th><th>Nombre</th><th>C√≥digo</th><th>Edad</th><th>Direcci√≥n</th><th>Sociedad</th><th>Acciones</th>
          </tr>
        </thead>
        <tbody id="tbody-activos"></tbody>
      </table>
    </div>

    <div id="tabla-baja" class="hidden">
      <table>
        <thead>
          <tr>
            <th>Foto</th><th>Nombre</th><th>C√≥digo</th><th>Edad</th><th>Direcci√≥n</th><th>Sociedad</th><th>Acciones</th>
          </tr>
        </thead>
        <tbody id="tbody-baja"></tbody>
      </table>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script type="module">
    // Import SDKs
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getFirestore, collection, addDoc, onSnapshot, doc, updateDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    // Tu configuraci√≥n de Firebase
    const firebaseConfig = {
  apiKey: "AIzaSyAyfPQzO7evryWcQ5d1lGV3z8aB-gFOh_k",
  authDomain: "iglesia-adoracion-viva.firebaseapp.com",
  databaseURL: "https://iglesia-adoracion-viva-default-rtdb.firebaseio.com",
  projectId: "iglesia-adoracion-viva",
  storageBucket: "iglesia-adoracion-viva.firebasestorage.app",
  messagingSenderId: "815332010058",
  appId: "1:815332010058:web:d2afff616469349d88deb3",
  measurementId: "G-43MZP6V55D"
};
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const colRef = collection(db, "miembros");

    const form = document.getElementById("member-form");
    const tbodyActivos = document.getElementById("tbody-activos");
    const tbodyBaja = document.getElementById("tbody-baja");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const miembro = {
        nombre: document.getElementById("nombre").value,
        codigo: document.getElementById("codigo").value,
        edad: document.getElementById("edad").value,
        direccion: document.getElementById("direccion").value,
        sociedad: document.getElementById("sociedad").value,
        estado: "activo",
      };
      await addDoc(colRef, miembro);
      form.reset();
      form.classList.add("hidden");
    });

    onSnapshot(colRef, (snapshot) => {
      tbodyActivos.innerHTML = "";
      tbodyBaja.innerHTML = "";
      snapshot.forEach((docSnap) => {
        const data = docSnap.data();
        const row = document.createElement("tr");
        row.innerHTML = `
          <td><img src="${data.foto || ''}" width="50"/></td>
          <td>${data.nombre}</td>
          <td>${data.codigo}</td>
          <td>${data.edad}</td>
          <td>${data.direccion}</td>
          <td>${data.sociedad}</td>
          <td class="actions">
            ${data.estado === "activo"
              ? `<button onclick="darDeBaja('${docSnap.id}')">Dar de baja</button>`
              : `<button onclick="reactivar('${docSnap.id}')">Reactivar</button>`
            }
          </td>
        `;
        if (data.estado === "activo") {
          tbodyActivos.appendChild(row);
        } else {
          tbodyBaja.appendChild(row);
        }
      });
    });

    window.darDeBaja = async (id) => {
      await updateDoc(doc(db, "miembros", id), { estado: "baja" });
    };

    window.reactivar = async (id) => {
      await updateDoc(doc(db, "miembros", id), { estado: "activo" });
    };

    window.toggleSidebar = () => {
      document.getElementById("sidebar").classList.toggle("collapsed");
      document.getElementById("main").classList.toggle("collapsed");
    };

    window.toggleForm = () => {
      document.getElementById("member-form").classList.toggle("hidden");
    };

    window.showTab = (tab) => {
      document.querySelectorAll(".tabs button").forEach(btn => btn.classList.remove("active"));
      document.querySelector(`.tabs button[onclick="showTab('${tab}')"]`).classList.add("active");
      document.getElementById("tabla-activos").classList.toggle("hidden", tab !== "activos");
      document.getElementById("tabla-baja").classList.toggle("hidden", tab !== "baja");
    };
  </script>
</body>
</html>
