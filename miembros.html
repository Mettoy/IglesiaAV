<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Miembros - Adoraci√≥n Viva</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet"/>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <style>
    * {box-sizing: border-box; font-family: 'Roboto', sans-serif;}
    body {margin: 0; background: #f4f4f9; color: #333; display: flex;}

    .sidebar {
      background: #292b2c;
      width: 240px;
      min-height: 100vh;
      padding: 20px;
      position: fixed;
      left: 0;
      transition: width 0.3s ease;
      overflow: hidden;
    }
    .sidebar img {width: 100%; margin-bottom: 20px;}
    .sidebar.collapsed {width: 70px;}
    .sidebar.collapsed .menu-text {display: none;}

    .toggle-btn {
      background: none;
      border: none;
      color: white;
      font-size: 24px;
      cursor: pointer;
      margin-bottom: 20px;
    }

    .content {
      margin-left: 240px;
      padding: 20px;
      width: 100%;
      transition: margin-left 0.3s ease;
    }
    .collapsed + .content {margin-left: 70px;}

    h1 {color: #555;}

    .form-container {
      background: #fff;
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 8px;
      display: none;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .form-row {margin-bottom: 15px;}
    .form-row label {display: block; margin-bottom: 5px;}
    .form-row input, .form-row select {
      width: 100%; padding: 10px;
      border: 1px solid #ccc; border-radius: 4px;
    }

    .btn {
      background: #4CAF50;
      color: white;
      padding: 10px 16px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 10px;
    }

    .btn-add {
      background: #007BFF;
      margin-bottom: 20px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      border-radius: 8px;
      overflow: hidden;
    }

    th, td {
      padding: 12px;
      border-bottom: 1px solid #ccc;
      text-align: left;
    }

    th {
      background: #007BFF;
      color: white;
    }

    .actions button {
      margin-right: 5px;
      border: none;
      background: none;
      cursor: pointer;
    }

    .pagination {
      margin-top: 10px;
      text-align: center;
    }
    .pagination button {
      padding: 8px 12px;
      margin: 2px;
      border: 1px solid #ccc;
      border-radius: 4px;
      background: white;
      cursor: pointer;
    }

    .photo-preview {
      max-width: 100px;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>

<div class="sidebar" id="sidebar">
  <button class="toggle-btn" onclick="toggleSidebar()">‚ò∞</button>
  <img src="https://azywyqozwwbfctxeokug.supabase.co/storage/v1/object/public/logos//images%20(1).png" alt="Logo"/>
  <div class="menu-text">Miembros</div>
</div>

<div class="content">
  <h1>Gesti√≥n de Miembros</h1>
  <button class="btn btn-add" onclick="toggleForm()">‚ûï A√±adir nuevo miembro</button>

  <div class="form-container" id="memberForm">
    <div class="form-row">
      <label for="photo">Foto:</label>
      <input type="file" id="photoInput" accept="image/*" onchange="previewPhoto()"/>
      <img id="photoPreview" class="photo-preview"/>
    </div>
    <div class="form-row">
      <label>Nombre completo:</label>
      <input type="text" id="nombre"/>
    </div>
    <div class="form-row">
      <label>Edad:</label>
      <input type="number" id="edad"/>
    </div>
    <div class="form-row">
      <label>Direcci√≥n:</label>
      <input type="text" id="direccion"/>
    </div>
    <div class="form-row">
      <label>Sociedad:</label>
      <select id="sociedad">
        <option value="j√≥venes">J√≥venes</option>
        <option value="damas">Damas</option>
        <option value="caballeros">Caballeros</option>
      </select>
    </div>
    <button class="btn" onclick="guardarMiembro()">Guardar miembro</button>
  </div>

  <table id="miembrosTable">
    <thead>
      <tr>
        <th>Foto</th>
        <th>Nombre</th>
        <th>Edad</th>
        <th>Direcci√≥n</th>
        <th>Sociedad</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div class="pagination" id="pagination"></div>
</div>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyAyfPQzO7evryWcQ5d1lGV3z8aB-gFOh_k",
    authDomain: "iglesia-adoracion-viva.firebaseapp.com",
    projectId: "iglesia-adoracion-viva",
    storageBucket: "iglesia-adoracion-viva.appspot.com",
    messagingSenderId: "815332010058",
    appId: "1:815332010058:web:d2afff616469349d88deb3",
    measurementId: "G-43MZP6V55D"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const form = document.getElementById("memberForm");
  const tableBody = document.querySelector("#miembrosTable tbody");
  const paginationDiv = document.getElementById("pagination");

  let miembros = [];
  let currentPage = 1;
  const itemsPerPage = 20;

  function toggleSidebar() {
    document.getElementById("sidebar").classList.toggle("collapsed");
    document.querySelector(".content").classList.toggle("collapsed");
  }

  function toggleForm() {
    form.style.display = form.style.display === "none" ? "block" : "none";
  }

  function previewPhoto() {
    const file = document.getElementById("photoInput").files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = e => document.getElementById("photoPreview").src = e.target.result;
      reader.readAsDataURL(file);
    }
  }

  async function guardarMiembro() {
    const nombre = document.getElementById("nombre").value;
    const edad = document.getElementById("edad").value;
    const direccion = document.getElementById("direccion").value;
    const sociedad = document.getElementById("sociedad").value;
    const foto = document.getElementById("photoPreview").src;

    await db.collection("miembros").add({
      nombre, edad, direccion, sociedad, foto, activo: true
    });

    cargarMiembros();
    form.reset();
    document.getElementById("photoPreview").src = "";
    form.style.display = "none";
  }

  function renderMiembros() {
    const sorted = miembros.filter(m => m.activo).sort((a, b) => a.nombre.localeCompare(b.nombre));
    const start = (currentPage - 1) * itemsPerPage;
    const paginated = sorted.slice(start, start + itemsPerPage);
    
    tableBody.innerHTML = "";
    paginated.forEach(doc => {
      const row = document.createElement("tr");
      row.innerHTML = `
        <td><img src="${doc.foto}" width="40"/></td>
        <td>${doc.nombre}</td>
        <td>${doc.edad}</td>
        <td>${doc.direccion}</td>
        <td>${doc.sociedad}</td>
        <td class="actions">
          <button onclick="editarMiembro('${doc.id}')">‚úèÔ∏è</button>
          <button onclick="darDeBaja('${doc.id}')">üóëÔ∏è</button>
        </td>
      `;
      tableBody.appendChild(row);
    });

    renderPagination(sorted.length);
  }

  function renderPagination(totalItems) {
    const totalPages = Math.ceil(totalItems / itemsPerPage);
    paginationDiv.innerHTML = "";
    for (let i = 1; i <= totalPages; i++) {
      const btn = document.createElement("button");
      btn.textContent = i;
      if (i === currentPage) btn.style.background = "#007BFF";
      btn.onclick = () => { currentPage = i; renderMiembros(); };
      paginationDiv.appendChild(btn);
    }
  }

  function editarMiembro(id) {
    alert("Funci√≥n de edici√≥n pendiente para ID: " + id);
  }

  async function darDeBaja(id) {
    await db.collection("miembros").doc(id).update({activo: false});
    cargarMiembros();
  }

  async function cargarMiembros() {
    const snapshot = await db.collection("miembros").get();
    miembros = snapshot.docs.map(doc => ({id: doc.id, ...doc.data()}));
    renderMiembros();
  }

  cargarMiembros();
</script>

</body>
</html>
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Miembros - Adoraci√≥n Viva</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet"/>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <style>
    * {box-sizing: border-box; font-family: 'Roboto', sans-serif;}
    body {margin: 0; background: #f4f4f9; color: #333; display: flex;}

    .sidebar {
      background: #292b2c;
      width: 240px;
      min-height: 100vh;
      padding: 20px;
      position: fixed;
      left: 0;
      transition: width 0.3s ease;
      overflow: hidden;
    }
    .sidebar img {width: 100%; margin-bottom: 20px;}
    .sidebar.collapsed {width: 70px;}
    .sidebar.collapsed .menu-text {display: none;}

    .toggle-btn {
      background: none;
      border: none;
      color: white;
      font-size: 24px;
      cursor: pointer;
      margin-bottom: 20px;
    }

    .content {
      margin-left: 240px;
      padding: 20px;
      width: 100%;
      transition: margin-left 0.3s ease;
    }
    .collapsed + .content {margin-left: 70px;}

    h1 {color: #555;}

    .form-container {
      background: #fff;
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 8px;
      display: none;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .form-row {margin-bottom: 15px;}
    .form-row label {display: block; margin-bottom: 5px;}
    .form-row input, .form-row select {
      width: 100%; padding: 10px;
      border: 1px solid #ccc; border-radius: 4px;
    }

    .btn {
      background: #4CAF50;
      color: white;
      padding: 10px 16px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      margin-top: 10px;
    }

    .btn-add {
      background: #007BFF;
      margin-bottom: 20px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      border-radius: 8px;
      overflow: hidden;
    }

    th, td {
      padding: 12px;
      border-bottom: 1px solid #ccc;
      text-align: left;
    }

    th {
      background: #007BFF;
      color: white;
    }

    .actions button {
      margin-right: 5px;
      border: none;
      background: none;
      cursor: pointer;
    }

    .pagination {
      margin-top: 10px;
      text-align: center;
    }
    .pagination button {
      padding: 8px 12px;
      margin: 2px;
      border: 1px solid #ccc;
      border-radius: 4px;
      background: white;
      cursor: pointer;
    }

    .photo-preview {
      max-width: 100px;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>

<div class="sidebar" id="sidebar">
  <button class="toggle-btn" onclick="toggleSidebar()">‚ò∞</button>
  <img src="https://azywyqozwwbfctxeokug.supabase.co/storage/v1/object/public/logos//images%20(1).png" alt="Logo"/>
  <div class="menu-text">Miembros</div>
</div>

<div class="content">
  <h1>Gesti√≥n de Miembros</h1>
  <button class="btn btn-add" onclick="toggleForm()">‚ûï A√±adir nuevo miembro</button>

  <div class="form-container" id="memberForm">
    <div class="form-row">
      <label for="photo">Foto:</label>
      <input type="file" id="photoInput" accept="image/*" onchange="previewPhoto()"/>
      <img id="photoPreview" class="photo-preview"/>
    </div>
    <div class="form-row">
      <label>Nombre completo:</label>
      <input type="text" id="nombre"/>
    </div>
    <div class="form-row">
      <label>Edad:</label>
      <input type="number" id="edad"/>
    </div>
    <div class="form-row">
      <label>Direcci√≥n:</label>
      <input type="text" id="direccion"/>
    </div>
    <div class="form-row">
      <label>Sociedad:</label>
      <select id="sociedad">
        <option value="j√≥venes">J√≥venes</option>
        <option value="damas">Damas</option>
        <option value="caballeros">Caballeros</option>
      </select>
    </div>
    <button class="btn" onclick="guardarMiembro()">Guardar miembro</button>
  </div>

  <table id="miembrosTable">
    <thead>
      <tr>
        <th>Foto</th>
        <th>Nombre</th>
        <th>Edad</th>
        <th>Direcci√≥n</th>
        <th>Sociedad</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <div class="pagination" id="pagination"></div>
</div>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyAyfPQzO7evryWcQ5d1lGV3z8aB-gFOh_k",
    authDomain: "iglesia-adoracion-viva.firebaseapp.com",
    projectId: "iglesia-adoracion-viva",
    storageBucket: "iglesia-adoracion-viva.appspot.com",
    messagingSenderId: "815332010058",
    appId: "1:815332010058:web:d2afff616469349d88deb3",
    measurementId: "G-43MZP6V55D"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const form = document.getElementById("memberForm");
  const tableBody = document.querySelector("#miembrosTable tbody");
  const paginationDiv = document.getElementById("pagination");

  let miembros = [];
  let currentPage = 1;
  const itemsPerPage = 20;

  function toggleSidebar() {
    document.getElementById("sidebar").classList.toggle("collapsed");
    document.querySelector(".content").classList.toggle("collapsed");
  }

  function toggleForm() {
    form.style.display = form.style.display === "none" ? "block" : "none";
  }

  function previewPhoto() {
    const file = document.getElementById("photoInput").files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = e => document.getElementById("photoPreview").src = e.target.result;
      reader.readAsDataURL(file);
    }
  }

  async function guardarMiembro() {
    const nombre = document.getElementById("nombre").value;
    const edad = document.getElementById("edad").value;
    const direccion = document.getElementById("direccion").value;
    const sociedad = document.getElementById("sociedad").value;
    const foto = document.getElementById("photoPreview").src;

    await db.collection("miembros").add({
      nombre, edad, direccion, sociedad, foto, activo: true
    });

    cargarMiembros();
    form.reset();
    document.getElementById("photoPreview").src = "";
    form.style.display = "none";
  }

  function renderMiembros() {
    const sorted = miembros.filter(m => m.activo).sort((a, b) => a.nombre.localeCompare(b.nombre));
    const start = (currentPage - 1) * itemsPerPage;
    const paginated = sorted.slice(start, start + itemsPerPage);
    
    tableBody.innerHTML = "";
    paginated.forEach(doc => {
      const row = document.createElement("tr");
      row.innerHTML = `
        <td><img src="${doc.foto}" width="40"/></td>
        <td>${doc.nombre}</td>
        <td>${doc.edad}</td>
        <td>${doc.direccion}</td>
        <td>${doc.sociedad}</td>
        <td class="actions">
          <button onclick="editarMiembro('${doc.id}')">‚úèÔ∏è</button>
          <button onclick="darDeBaja('${doc.id}')">üóëÔ∏è</button>
        </td>
      `;
      tableBody.appendChild(row);
    });

    renderPagination(sorted.length);
  }

  function renderPagination(totalItems) {
    const totalPages = Math.ceil(totalItems / itemsPerPage);
    paginationDiv.innerHTML = "";
    for (let i = 1; i <= totalPages; i++) {
      const btn = document.createElement("button");
      btn.textContent = i;
      if (i === currentPage) btn.style.background = "#007BFF";
      btn.onclick = () => { currentPage = i; renderMiembros(); };
      paginationDiv.appendChild(btn);
    }
  }

  function editarMiembro(id) {
    alert("Funci√≥n de edici√≥n pendiente para ID: " + id);
  }

  async function darDeBaja(id) {
    await db.collection("miembros").doc(id).update({activo: false});
    cargarMiembros();
  }

  async function cargarMiembros() {
    const snapshot = await db.collection("miembros").get();
    miembros = snapshot.docs.map(doc => ({id: doc.id, ...doc.data()}));
    renderMiembros();
  }

  cargarMiembros();
</script>

</body>
</html>
